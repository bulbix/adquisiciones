<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2">

  <query name="Usuario.VerificaUsuario">
    <![CDATA[
    
    select u 
    from Usuario u 
    join fetch u.UsuarioModulo um 
    join fetch um.Id.Modulo m 
    join fetch m.Id.Almacen a 
    where u.Rfc = :rfc and u.Password = :pwd 
    order by m.Id.IdModulo asc  ]]>
  </query>

  <query name="Usuario.SinPerfiles">
    <![CDATA[ 
    select m
    from Modulo m 
    where m.Id.IdModulo not in 
    (select um.Id.Modulo.Id.IdModulo 
    from UsuarioModulo um 
    where um.Id.Usuario = :usuario 
    and um.Id.Modulo.Id.Almacen = :almacen)
    and m.Id.Almacen = :almacen 
    
   ]]>
  </query>

  <query name="Usuario.ConPerfiles">
    <![CDATA[    
    select m
    from Modulo m 
    where m.Id.IdModulo in 
    (select um.Id.Modulo.Id.IdModulo 
    from UsuarioModulo um 
    where um.Id.Usuario = :usuario 
    and um.Id.Modulo.Id.Almacen = :almacen)
    order by m.DesModulo]]>
  </query>
  
  
  
  
  <query name="Usuario.CargaCombo">
    <![CDATA[from Usuario]]>
  </query>
  
  
  <query name="Usuario.TraeUsuario">
    <![CDATA[from Usuario u 
              where u.Nombre = :nombre_usua]]>
  </query>
  <query name="Articulo.CostoPromedio">
    <![CDATA[from Articulo a where a.Id.Almacen.IdAlmacen = :idAlmacen 
             and a.Id.CveArt = :cve_art]]>
  </query>

  <query name="CatArea.CargaAreas">
    <![CDATA[from CatArea a  
              where a.Tipo = :tipo order by DesArea]]>
  </query>
  <query name="CatArea.TraeArea">
    <![CDATA[from CatArea c 
              where c.DesArea = :des_area]]>
  </query>
  <query name="CatArea.TraeAreaCve">
    <![CDATA[from CatArea c 
              where c.CveArea = :cve_area]]>
  </query>

  <query name="TipoIva.Carga">
    <![CDATA[from Iva a where a.Estatus = :estado ]]>
  </query>
  <query name="TipoIva.Id">
    <![CDATA[from Iva a where a.Id.Porcentaje = :tipoiva]]>
  </query>

  <query name="TipoLicitacion.Carga">
    <![CDATA[from TipoLicitacion ]]>
  </query>
  
  <query name="TipoLicitacion.Id">
    <![CDATA[from TipoLicitacion a where a.DesTipolicitacion = :tipolicita]]>
  </query>


</hibernate-mapping>
